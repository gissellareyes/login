const nodemailer = require('nodemailer');
const ejs = require("ejs");

module.exports = (config, cb) => {
  const smtpConfig = {
    host: config.smtpHost,
    port: 465,
    secure: true, // use SSL
    auth: {
      user: config.smtpUser,
      pass: config.smtpPass
    }
  };

  const transporter = nodemailer.createTransport(smtpConfig);
  const mailOptions = {
    from: config.from,
    to: config.to,
    cc: config.cc,
    subject: config.subject,
    html: ejs.render(config.htmlStr, config.htmlContext),
    attachments: config.attachments
  };
  transporter.sendMail(mailOptions, cb);
};
